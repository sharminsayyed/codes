


Q.1) Consider the following database:   
  
Doctor (dno, dname, addr, phone_no, specialization)  
Patient (pno, pat_name, city, disease)  
  
The relationship is as follows: Doctor-Patient: many-to-many.  
  
A) Create above database in PostgreSQL and insert sufficient records.                       
Execute the following queries in PostGreSQL   
        
i) Find the names of all doctors which start with “M”.   
ii) Count the number of doctors who are Neurologists.   
iii) Give the list of all patients who are suffering from “Fever”. 
iv) Find the specialization and phone numbers of all doctors from Alandi.   
  
B) Write a stored function using cursors to display all the details of all Patients from Nashik     
               city.   

ANSWER --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------->

create table doctor(dno int primary key , dname varchar(20),dadd varchar(20) ,phn varchar(20),dsep varchar(20));

create table patient(pno int primary key ,pname varchar(20) ,pcity varchar(20),disease varchar(20));


pno |  pname  | pcity  | disease
-----+---------+--------+---------
   1 | sharmin | nashik | cough
   2 | saad    | pune   | fever
   3 | emaan   | nashik | tb
   4 | ghazal  | mumbai | fever


 dno | dname  |  dadd  |    phn     |      dsep
-----+--------+--------+------------+-----------------
   1 | mohsin | pune   | 2334455661 | ortho
   2 | saad   | mumbai | 9012346711 | neuro
   3 | emaan  | alandi | 9012342331 | pythiotherapist
   4 | mahera | pune   | 9089225661 | ortho
   5 | sania  | alandi | 9231222231 | pythiotherapist
   6 | raj    | pune   | 2343129011 | neuro



i) Find the names of all doctors which start with “M”.   
--> select * from doctor where dname like 'm%';

ii) Count the number of doctors who are Neurologists.   
--> select count(dno) from doctor where dsep='neuro';

iii) Give the list of all patients who are suffering from “Fever”. 
-->select * from patient where disease='fever';

iv) Find the specialization and phone numbers of all doctors from Alandi.   
--> select * from doctor where dadd='alandi';



B) Write a stored function using cursors to display all the details of all Patients from Nashik     
               city. 

-------->

create or replace function get_details() returns void as $$
declare 
	prec patient%rowtype;
	pcur cursor for select * from patient where pcity='nashik';
begin
	open pcur;
	loop
		fetch pcur into prec ;
		raise notice 'patient no : % , name : % ,pcity : %, disease :%',prec.pno , prec.pname,prec.pcity,prec.disease;
		exit when not found;
	end loop;
	close pcur;
end;
$$ language 'plpgsql';


 select get_details();
NOTICE:  patient no : 1 , name : sharmin ,pcity : nashik, disease :cough
NOTICE:  patient no : 3 , name : emaan ,pcity : nashik, disease :tb
NOTICE:  patient no : <NULL> , name : <NULL> ,pcity : <NULL>, disease :<NULL>
 get_details
-------------